{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 75fe1b406d229371a08b","webpack:///./src/Branch.js","webpack:///external \"babel-polyfill\"","webpack:///./src/index.js","webpack:///./src/convertToBranches.js","webpack:///./src/executeBranch.js","webpack:///external \"bluebird\""],"names":["Branch","name","condition","action","value","branches","TypeError","slice","newCondition","newAction","newName","branch","push","find","getName","searchName","getBranch","Object","keys","reduce","foundBranch","branchName","findBranch","convertToBranches","convertToBranch","map","executeBranch","currentBranch","resolve","then","conditionResult","executeBranchAction","getBranchByCondition","getBranches","actionResult","childBranch","spread","index","length","branchCondition","getCondition","branchValue"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 75fe1b406d229371a08b","import { convertToBranches, convertToBranch } from \"./convertToBranches\";\nimport executeBranch from \"./executeBranch\";\nexport default class Branch {\n    constructor({ name, condition = () => true, action = value => value, branches = [] } = {}) {\n        if (!name) {\n            throw TypeError(\"Name should be provided\");\n        }\n        this.name = name;\n        this.condition = condition;\n        this.action = action;\n        this.branches = convertToBranches(branches);\n    }\n    clone() {\n        return new Branch({\n            name: this.name,\n            condition: this.condition,\n            action: this.action,\n            branches: this.branches.slice()\n        });\n    }\n    setCondition(newCondition) {\n        this.condition = newCondition;\n        return this;\n    }\n    setAction(newAction) {\n        this.action = newAction;\n        return this;\n    }\n    setName(newName) {\n        this.name = newName;\n        return this;\n    }\n    addBranch(branch) {\n        this.branches.push(convertToBranch(branch));\n        return this;\n    }\n    getBranches() {\n        return this.branches;\n    }\n    getBranch(name) {\n        return this.branches.find(branch => branch.getName() === name) || null;\n    }\n    findBranch(searchName) {\n        return (\n            this.getBranch(searchName) ||\n            Object.keys(this.branches).reduce(\n                (foundBranch, branchName) => foundBranch || this.branches[branchName].findBranch(searchName),\n                null\n            )\n        );\n    }\n    getAction() {\n        return this.action;\n    }\n    getCondition() {\n        return this.condition;\n    }\n    getName() {\n        return this.name;\n    }\n    execute(value) {\n        return executeBranch(value, { branch: this });\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Branch.js","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 2\n// module chunks = 0","import Branch from \"./Branch\";\nexport default {\n    Branch\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Branch from \"./Branch\";\nexport function convertToBranches(branches) {\n    return branches.map(convertToBranch);\n}\nexport function convertToBranch(branch) {\n    if (branch instanceof Branch) {\n        return branch;\n    } else {\n        return new Branch(branch);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/convertToBranches.js","import Promise from \"bluebird\";\nexport default function executeBranch(value, { branch: currentBranch }) {\n    return (\n        Promise.resolve()\n            // TODO: consider if we want check condition of main/root branch\n            .then(() => currentBranch.condition(value))\n            .then(conditionResult => (conditionResult ? executeBranchAction(value, { branch: currentBranch }) : value))\n    );\n}\n\nfunction executeBranchAction(value, { branch: currentBranch }) {\n    return Promise.resolve()\n        .then(() => currentBranch.action(value))\n        .then(actionResult =>\n            getBranchByCondition(currentBranch.getBranches(), actionResult).then(childBranch => [\n                actionResult,\n                childBranch\n            ])\n        )\n        .spread(\n            (actionResult, childBranch) =>\n                childBranch ? executeBranchAction(actionResult, { branch: childBranch }) : actionResult\n        );\n}\n\nfunction getBranchByCondition(branches, value, index = 0) {\n    if (branches.length <= index) {\n        return Promise.resolve(null);\n    }\n    const branch = branches[index];\n    const branchCondition = branch.getCondition();\n    return Promise.resolve()\n        .then(() => branchCondition(value))\n        .then(\n            branchValue => (branchValue ? Promise.resolve(branch) : getBranchByCondition(branches, value, index + 1))\n        );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/executeBranch.js","module.exports = require(\"bluebird\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bluebird\"\n// module id = 6\n// module chunks = 0"],"sourceRoot":""}