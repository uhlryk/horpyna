{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 9f45354d0f43a1ab8b11","webpack:///./src/Branch.js","webpack:///external \"babel-polyfill\"","webpack:///./src/index.js","webpack:///./src/convertToBranches.js","webpack:///./src/executeBranch.js","webpack:///external \"bluebird\""],"names":["Branch","name","condition","action","value","branches","catchHandlerMode","TypeError","slice","newCondition","newAction","newName","branch","push","find","getName","searchName","getBranch","Object","keys","reduce","foundBranch","branchName","findBranch","convertToBranches","convertToBranch","map","executeBranch","currentBranch","resolve","then","conditionResult","executeBranchAction","getBranchByCondition","getBranches","actionResult","childBranch","err","reject","index","length","branchCondition","getCondition","isCatchHandlerMode","branchValue"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9f45354d0f43a1ab8b11","import { convertToBranches, convertToBranch } from \"./convertToBranches\";\nimport executeBranch from \"./executeBranch\";\nexport default class Branch {\n    constructor({\n        name,\n        condition = () => true,\n        action = value => value,\n        branches = [],\n        catchHandlerMode = false\n    } = {}) {\n        if (!name) {\n            throw TypeError(\"Name should be provided\");\n        }\n        this.name = name;\n        this.condition = condition;\n        this.action = action;\n        this.catchHandlerMode = catchHandlerMode;\n        this.branches = convertToBranches(branches);\n    }\n    clone() {\n        return new Branch({\n            name: this.name,\n            condition: this.condition,\n            action: this.action,\n            catchHandlerMode: this.catchHandlerMode,\n            branches: this.branches.slice()\n        });\n    }\n    isCatchHandlerMode() {\n        return this.catchHandlerMode;\n    }\n    setCondition(newCondition) {\n        this.condition = newCondition;\n        return this;\n    }\n    setAction(newAction) {\n        this.action = newAction;\n        return this;\n    }\n    setName(newName) {\n        this.name = newName;\n        return this;\n    }\n    addBranch(branch) {\n        this.branches.push(convertToBranch(branch));\n        return this;\n    }\n    getBranches() {\n        return this.branches;\n    }\n    getBranch(name) {\n        return this.branches.find(branch => branch.getName() === name) || null;\n    }\n    findBranch(searchName) {\n        return (\n            this.getBranch(searchName) ||\n            Object.keys(this.branches).reduce(\n                (foundBranch, branchName) => foundBranch || this.branches[branchName].findBranch(searchName),\n                null\n            )\n        );\n    }\n    getAction() {\n        return this.action;\n    }\n    getCondition() {\n        return this.condition;\n    }\n    getName() {\n        return this.name;\n    }\n    execute(value) {\n        return executeBranch(value, { branch: this });\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Branch.js","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 2\n// module chunks = 0","import Branch from \"./Branch\";\nexport default {\n    Branch\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Branch from \"./Branch\";\nexport function convertToBranches(branches) {\n    return branches.map(convertToBranch);\n}\nexport function convertToBranch(branch) {\n    if (branch instanceof Branch) {\n        return branch;\n    } else {\n        return new Branch(branch);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/convertToBranches.js","import Promise from \"bluebird\";\nexport default function executeBranch(value, { branch: currentBranch }) {\n    return (\n        Promise.resolve()\n            // TODO: consider if we want check condition of main/root branch\n            .then(() => currentBranch.condition(value))\n            .then(conditionResult => (conditionResult ? executeBranchAction(value, { branch: currentBranch }) : value))\n    );\n}\n\nfunction executeBranchAction(value, { branch: currentBranch }) {\n    return Promise.resolve()\n        .then(() => currentBranch.action(value))\n        .then(\n            actionResult =>\n                getBranchByCondition(currentBranch.getBranches(), actionResult, 0, false).then(\n                    childBranch =>\n                        childBranch ? executeBranchAction(actionResult, { branch: childBranch }) : actionResult\n                ),\n            err =>\n                getBranchByCondition(currentBranch.getBranches(), err, 0, true).then(\n                    childBranch =>\n                        childBranch ? executeBranchAction(err, { branch: childBranch }) : Promise.reject(err)\n                )\n        );\n}\n\nfunction getBranchByCondition(branches, value, index = 0, catchHandlerMode) {\n    if (branches.length <= index) {\n        return Promise.resolve(null);\n    }\n    const branch = branches[index];\n    const branchCondition = branch.getCondition();\n    return Promise.resolve()\n        .then(() => branch.isCatchHandlerMode() === catchHandlerMode && branchCondition(value))\n        .then(\n            branchValue =>\n                branchValue\n                    ? Promise.resolve(branch)\n                    : getBranchByCondition(branches, value, index + 1, catchHandlerMode)\n        );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/executeBranch.js","module.exports = require(\"bluebird\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bluebird\"\n// module id = 6\n// module chunks = 0"],"sourceRoot":""}